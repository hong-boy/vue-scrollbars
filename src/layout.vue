<template>
    <div v-bar.debug class="scrollbar-dynamic wrapper">
        <div class="page-content">
            <h1>Basic Scrollbars</h1>
            <div class="container">
                <h2>Simple Inner</h2>
                <div class="controls"></div>
                <div class="content">
                    <div class="demo">
                        <div v-bar class="scrollbar-inner simple-inner">
                            <p>
                                Lorem ipsum dolor sit amet, consectetur adipisicing elit. Proin nibh augue, suscipit a,
                                scelerisque sed, lacinia in, mi. Cras vel lorem. Etiam pellentesque aliquet tellus.
                                Phasellus pharetra nulla ac diam. Quisque semper justo at risus. Donec venenatis, turpis
                                vel
                                hendrerit interdum, dui ligula ultricies purus, sed posuere libero dui id orci. Nam
                                congue,
                                pede vitae dapibus aliquet, elit magna vulputate arcu, vel tempus metus leo non est.
                                Etiam sit
                                amet lectus quis est congue mollis. Phasellus congue lacus eget neque. Phasellus ornare,
                                ante
                                vitae consectetuer consequat, purus sapien ultricies dolor, et mollis pede metus eget
                                nisi.
                                Praesent sodales velit quis augue. Cras suscipit, urna at aliquam rhoncus, urna quam
                                viverra
                                nisi, in interdum massa nibh nec erat.
                            </p>
                            <p>
                                Lorem ipsum dolor sit amet, consectetur adipisicing elit. Proin nibh augue, suscipit a,
                                scelerisque sed, lacinia in, mi. Cras vel lorem. Etiam pellentesque aliquet tellus.
                                Phasellus pharetra nulla ac diam. Quisque semper justo at risus. Donec venenatis, turpis
                                vel
                                hendrerit interdum, dui ligula ultricies purus, sed posuere libero dui id orci. Nam
                                congue,
                                pede vitae dapibus aliquet, elit magna vulputate arcu, vel tempus metus leo non est.
                                Etiam sit
                                amet lectus quis est congue mollis. Phasellus congue lacus eget neque. Phasellus ornare,
                                ante
                                vitae consectetuer consequat, purus sapien ultricies dolor, et mollis pede metus eget
                                nisi.
                                Praesent sodales velit quis augue. Cras suscipit, urna at aliquam rhoncus, urna quam
                                viverra
                                nisi, in interdum massa nibh nec erat.
                            </p>
                            <p>
                                Lorem ipsum dolor sit amet, consectetur adipisicing elit. Proin nibh augue, suscipit a,
                                scelerisque sed, lacinia in, mi. Cras vel lorem. Etiam pellentesque aliquet tellus.
                                Phasellus pharetra nulla ac diam. Quisque semper justo at risus. Donec venenatis, turpis
                                vel
                                hendrerit interdum, dui ligula ultricies purus, sed posuere libero dui id orci. Nam
                                congue,
                                pede vitae dapibus aliquet, elit magna vulputate arcu, vel tempus metus leo non est.
                                Etiam sit
                                amet lectus quis est congue mollis. Phasellus congue lacus eget neque. Phasellus ornare,
                                ante
                                vitae consectetuer consequat, purus sapien ultricies dolor, et mollis pede metus eget
                                nisi.
                                Praesent sodales velit quis augue. Cras suscipit, urna at aliquam rhoncus, urna quam
                                viverra
                                nisi, in interdum massa nibh nec erat.
                            </p>
                            <p>
                                Lorem ipsum dolor sit amet, consectetur adipisicing elit. Proin nibh augue, suscipit a,
                                scelerisque sed, lacinia in, mi. Cras vel lorem. Etiam pellentesque aliquet tellus.
                                Phasellus pharetra nulla ac diam. Quisque semper justo at risus. Donec venenatis, turpis
                                vel
                                hendrerit interdum, dui ligula ultricies purus, sed posuere libero dui id orci. Nam
                                congue,
                                pede vitae dapibus aliquet, elit magna vulputate arcu, vel tempus metus leo non est.
                                Etiam sit
                                amet lectus quis est congue mollis. Phasellus congue lacus eget neque. Phasellus ornare,
                                ante
                                vitae consectetuer consequat, purus sapien ultricies dolor, et mollis pede metus eget
                                nisi.
                                Praesent sodales velit quis augue. Cras suscipit, urna at aliquam rhoncus, urna quam
                                viverra
                                nisi, in interdum massa nibh nec erat.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container">
                <h2>Textarea</h2>
                <div class="controls"></div>
                <div class="content">
                    <div class="demo">
                        <textarea v-bar="{disableBodyScroll:true}" class="scrollbar-outer textarea-scrollbar">
                            <p>
                                Lorem ipsum dolor sit amet, consectetur adipisicing elit. Proin nibh augue, suscipit a,
                                scelerisque sed, lacinia in, mi. Cras vel lorem. Etiam pellentesque aliquet tellus.
                                Phasellus pharetra nulla ac diam. Quisque semper justo at risus. Donec venenatis, turpis vel
                                hendrerit interdum, dui ligula ultricies purus, sed posuere libero dui id orci. Nam congue,
                                pede vitae dapibus aliquet, elit magna vulputate arcu, vel tempus metus leo non est. Etiam sit
                                amet lectus quis est congue mollis. Phasellus congue lacus eget neque. Phasellus ornare, ante
                                vitae consectetuer consequat, purus sapien ultricies dolor, et mollis pede metus eget nisi.
                                Praesent sodales velit quis augue. Cras suscipit, urna at aliquam rhoncus, urna quam viverra
                                nisi, in interdum massa nibh nec erat.
                            </p>
                            <p>
                                Lorem ipsum dolor sit amet, consectetur adipisicing elit. Proin nibh augue, suscipit a,
                                scelerisque sed, lacinia in, mi. Cras vel lorem. Etiam pellentesque aliquet tellus.
                                Phasellus pharetra nulla ac diam. Quisque semper justo at risus. Donec venenatis, turpis vel
                                hendrerit interdum, dui ligula ultricies purus, sed posuere libero dui id orci. Nam congue,
                                pede vitae dapibus aliquet, elit magna vulputate arcu, vel tempus metus leo non est. Etiam sit
                                amet lectus quis est congue mollis. Phasellus congue lacus eget neque. Phasellus ornare, ante
                                vitae consectetuer consequat, purus sapien ultricies dolor, et mollis pede metus eget nisi.
                                Praesent sodales velit quis augue. Cras suscipit, urna at aliquam rhoncus, urna quam viverra
                                nisi, in interdum massa nibh nec erat.
                            </p>
                            <p>
                                Lorem ipsum dolor sit amet, consectetur adipisicing elit. Proin nibh augue, suscipit a,
                                scelerisque sed, lacinia in, mi. Cras vel lorem. Etiam pellentesque aliquet tellus.
                                Phasellus pharetra nulla ac diam. Quisque semper justo at risus. Donec venenatis, turpis vel
                                hendrerit interdum, dui ligula ultricies purus, sed posuere libero dui id orci. Nam congue,
                                pede vitae dapibus aliquet, elit magna vulputate arcu, vel tempus metus leo non est. Etiam sit
                                amet lectus quis est congue mollis. Phasellus congue lacus eget neque. Phasellus ornare, ante
                                vitae consectetuer consequat, purus sapien ultricies dolor, et mollis pede metus eget nisi.
                                Praesent sodales velit quis augue. Cras suscipit, urna at aliquam rhoncus, urna quam viverra
                                nisi, in interdum massa nibh nec erat.
                            </p>
                            <p>
                                Lorem ipsum dolor sit amet, consectetur adipisicing elit. Proin nibh augue, suscipit a,
                                scelerisque sed, lacinia in, mi. Cras vel lorem. Etiam pellentesque aliquet tellus.
                                Phasellus pharetra nulla ac diam. Quisque semper justo at risus. Donec venenatis, turpis vel
                                hendrerit interdum, dui ligula ultricies purus, sed posuere libero dui id orci. Nam congue,
                                pede vitae dapibus aliquet, elit magna vulputate arcu, vel tempus metus leo non est. Etiam sit
                                amet lectus quis est congue mollis. Phasellus congue lacus eget neque. Phasellus ornare, ante
                                vitae consectetuer consequat, purus sapien ultricies dolor, et mollis pede metus eget nisi.
                                Praesent sodales velit quis augue. Cras suscipit, urna at aliquam rhoncus, urna quam viverra
                                nisi, in interdum massa nibh nec erat.
                            </p>
                        </textarea>
                    </div>
                </div>
            </div>
            <div class="container">
                <h2>Page Map</h2>
                <div class="controls"></div>
                <div class="content">
                    <div class="demo">
                        <scrollbar @onUpdate="onUpdate4PageMap">
                            <div slot="pageMap" class="scroll-element_outer">
                                <div class="scroll-element_size">
                                    <div class="scroll-element_track"></div>
                                    <div class="scroll-bar"></div>
                                </div>
                            </div>
                            <div slot="content" class="scrollbar-map map-scrollbar">
                                <img src="./tarzan.jpg" height="900" width="1200"/>
                            </div>
                        </scrollbar>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>

<script type="text/ecmascript-6">
    /**
     * Get inscribed area size
     *
     * @param int oW outer width
     * @param int oH outer height
     * @param int iW inner width
     * @param int iH inner height
     * @param bool R resize if smaller
     */
    function getInscribedArea(oW, oH, iW, iH, R){
        if(!R && iW < oW && iH < oH){
            return {
                "h": iH,
                "w": iW
            };
        }
        if((oW / oH) > (iW / iH)){
            return {
                "h": oH,
                "w": Math.round(oH * iW / iH)
            }
        } else {
            return {
                "h": Math.round(oW * iH / iW),
                "w": oW
            };
        }
    }

    function genScreenshot(dom){
        dom.style.backgroundImage = `url(${require('./tarzan.jpg')})`;
    }

    export default {
        data(){
            return {
                disableBodyScroll: false
            };
        },
        methods: {
            onscroll(...args){
                console.log(args)
            },
            onInit4PageMap(){

            },
            onUpdate4PageMap(scrollbar, container){
                let ret = getInscribedArea(140, 140, scrollbar.scrollx.size, scrollbar.scrolly.size);
                scrollbar.scrollx.scroll.style.width = `${ret.w}px`;
                scrollbar.scrolly.scroll.style.height = `${ret.h}px`;
                genScreenshot(scrollbar.scrollx.scroll);
            },
        },
        created(){
            setTimeout(() => {
                console.log('disabled scroll');
                this.disableBodyScroll = true
            }, 10000);
        }
    }
</script>

<style lang="less">
    body{
        width:100%;
        height:100%;
    }
    .wrapper{
        height:100vh; /** 需要显示声明height overflow: auto;*/
        width:100%;
    .scrollbar-dynamic{
        max-height:none;
    }
    }
    .page-content{
        margin:0 auto;
        max-width:1600px;
        padding:25px;
    }
    .controls{
        padding:0 0 10px;
    }
    .content{
        max-width:1200px;
    .demo{
        border:1px solid #ccc;
        padding:25px;
    }
    }
    .simple-inner{
        max-height:250px;
    }
    .textarea-scrollbar{
        height:250px;
        width:100%;
    }
    .map-scrollbar{
        width:100%;
        height:500px;
    }
</style>
